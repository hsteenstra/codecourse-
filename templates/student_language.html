{% extends "base.html" %}
{% block content %}

<div class="card card-pad-lg" style="margin-bottom: 16px;">
  <div class="row" style="justify-content: space-between; align-items: end; flex-wrap: wrap;">
    <div>
      <h1>{{ lang.name }}</h1>
      <p class="subtitle">Complete each lesson to unlock the next one.</p>
    </div>
    <div class="row" style="gap: 10px; flex-wrap: wrap;">
      <span class="pill-tag">Lessons: {{ lang.lessons|length }}</span>
      <span class="pill-tag good">Completed: {{ completed|length }}</span>
    </div>
  </div>
</div>

<div class="card card-pad-lg" style="margin-bottom: 16px;">
  <h2>Path</h2>
  <div class="roadmap" style="margin-top: 10px;">
    {% for lesson in lang.lessons %}
      {% if lesson.id in completed %}
        <div class="bubble completed">{{ lesson.id }}</div>
      {% elif lesson.id == (completed|length + 1) %}
        <a href="/student/lesson/{{ lang.id }}/{{ lesson.id }}" class="bubble active">{{ lesson.id }}</a>
      {% else %}
        <div class="bubble locked">{{ lesson.id }}</div>
      {% endif %}
    {% endfor %}
  </div>
</div>

<div class="card card-pad-lg">
  <h2>Lessons</h2>
  <div class="stack" style="margin-top: 10px;">
    {% for lesson in lang.lessons %}
      <div class="assignment-row">
        <div>
          <div style="font-weight: 900;">{{ lesson.title }}</div>
          <div class="muted">XP: {{ lesson.xp }}</div>
        </div>
        <div class="assignment-actions">
          {% if lesson.id in completed %}
            <span class="pill-tag good">Completed</span>
          {% elif lesson.id == (completed|length + 1) %}
            <a class="btn btn-primary" href="/student/lesson/{{ lang.id }}/{{ lesson.id }}">Start</a>
          {% else %}
            <span class="pill-tag">Locked</span>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>

  {% if completed|length == lang.lessons|length %}
    <div class="card" style="margin-top: 16px; padding: 16px; border-radius: 18px; background: rgba(15,157,88,0.06); border: 1px solid rgba(15,157,88,0.18);">
      <div class="row" style="justify-content: space-between; align-items: center; flex-wrap: wrap;">
        <div>
          <div style="font-weight: 900;">Certificate ready</div>
          <div class="muted">You completed {{ lang.name }} Basics.</div>
        </div>
        <a class="btn btn-secondary" href="/student/language/{{ lang.id }}/certificate">View certificate</a>
      </div>
    </div>
  {% endif %}
</div>

{% endblock %}
