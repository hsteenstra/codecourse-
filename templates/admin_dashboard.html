{% extends "base.html" %}
{% block content %}

<section class="card hero card-pad-lg">
  <div>
    <h1>Admin Dashboard</h1>
    <p class="subtitle">Add lessons, manage languages, and keep your content organized.</p>
  </div>
</section>

<div class="admin-layout">
  <div class="card card-pad-lg">
    <h2>Add Lesson</h2>
    <form method="post" action="/admin/lesson/create" class="form" style="margin-top: 10px;">
      <select name="lang_id" required>
        <option disabled selected>Select language</option>
        {% for lang in languages %}
          <option value="{{ lang.id }}">{{ lang.name }}</option>
        {% endfor %}
      </select>
      <input name="title" placeholder="Lesson title" required>
      <input name="xp" type="number" min="50" max="400" placeholder="XP (e.g., 150)">
      <textarea name="reading" rows="6" placeholder="Reading content" required></textarea>
      <input name="video_url" placeholder="Video embed URL (optional)">
      <textarea name="quiz_text" rows="8" placeholder="Quiz format: Question | A,B,C,D | Answer\nExample:\nWhat is Python? | A language, A game, A food, A car | A language" required></textarea>
      <button class="btn btn-primary" type="submit">Add Lesson</button>
    </form>
  </div>

  <div class="card card-pad-lg">
    <h2>Add Language</h2>
    <form method="post" action="/admin/language/create" class="form" style="margin-top: 10px;">
      <input name="lang_id" placeholder="Language id (e.g., rust)" required>
      <input name="name" placeholder="Language name" required>
      <input name="description" placeholder="Short description">
      <label class="checkbox">
        <input type="checkbox" name="enabled">
        Enable immediately
      </label>
      <button class="btn btn-secondary" type="submit">Add Language</button>
    </form>
  </div>
</div>

<div class="card card-pad-lg">
  <h2>Toggle Languages</h2>
  <form method="post" action="/admin/language/toggle" class="form" style="margin-top: 10px;">
    <select name="lang_id" required>
      <option disabled selected>Select language</option>
      {% for lang in languages %}
        <option value="{{ lang.id }}">{{ lang.name }}</option>
      {% endfor %}
    </select>
    <label class="checkbox">
      <input type="checkbox" name="enabled">
      Enable this language
    </label>
    <button class="btn btn-secondary" type="submit">Update Language</button>
  </form>
</div>

<div class="card card-pad-lg">
  <h2>Current Tracks</h2>
  <div class="stack" style="margin-top: 10px;">
    {% for lang in languages %}
      <div class="assignment-row">
        <div>
          <h3>{{ lang.name }}</h3>
          <p class="muted">ID: {{ lang.id }}</p>
        </div>
        <div class="assignment-actions">
          <span class="pill-tag {{ 'good' if lang.enabled else '' }}">{{ 'Enabled' if lang.enabled else 'Disabled' }}</span>
          <span class="pill-tag">Lessons: {{ lang.lessons|length }}</span>
        </div>
      </div>
      {% if lang.lessons %}
        <div class="lesson-edit-list">
          {% for lesson in lang.lessons %}
            <div class="lesson-edit-row">
              <div>
                <strong>Lesson {{ lesson.id }}:</strong> {{ lesson.title }}
              </div>
              <a href="/admin/lesson/{{ lang.id }}/{{ lesson.id }}" class="btn btn-secondary">Edit</a>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

{% endblock %}
