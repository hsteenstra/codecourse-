{% extends "base.html" %}
{% block content %}

<section class="classroom-hero">
  <div>
    <h1>Classroom Stream</h1>
    <p class="subtitle">Assignments feed with quick access to join new classes.</p>
  </div>
</section>

<div class="classroom-layout">
  <div class="stream">
    {% if stream_items %}
      <div class="card stream-card">
        <h2>Classroom Stream</h2>
        <div class="stream-list">
          {% for item in stream_items %}
            <div class="stream-item">
              <div class="stream-title">{{ item.title }}</div>
              <div class="stream-body">{{ item.body }}</div>
              <div class="muted">{{ item.created_at }}</div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    <div class="card assignment-card">
      <h2>Assignments</h2>
      {% if assignments %}
        <div class="assignment-list">
          {% for a in assignments %}
            <div class="assignment-row">
              <div>
                <h3>{{ a.lesson_lang|upper }} Lesson {{ a.lesson_id }}</h3>
                <p class="muted">{{ a.classroom_name }}</p>
                {% if a.comment %}
                  <p class="muted">Teacher note: {{ a.comment }}</p>
                {% endif %}
                {% if a.due_date %}
                  <p class="muted">Due: {{ a.due_date }}</p>
                {% endif %}
                <form method="post" action="/student/assignment/{{ a.id }}/comment" class="comment-form">
                  <input name="comment" placeholder="Comment to your teacher">
                  <button class="ghost">Send</button>
                </form>
              </div>
              <div class="assignment-actions">
            {% if a.status == 'completed' %}
              <span class="pill completed">Completed</span>
            {% else %}
              <span class="pill active">Needs work</span>
            {% endif %}
            {% if a.grade_out_of_10 is not none %}
              <span class="pill grade">Grade: {{ a.grade_out_of_10 }}/10</span>
            {% endif %}
            <a href="/student/lesson/{{ a.lesson_lang }}/{{ a.lesson_id }}"><button class="secondary">Open Lesson</button></a>
          </div>
        </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="muted">No assignments yet. Ask your teacher to post one.</p>
      {% endif %}
    </div>
  </div>

  <aside class="class-sidebar">
    <div class="card join-card">
      <h2>Join a classroom</h2>
      <form method="post">
        <input name="code" placeholder="Enter classroom code" required>
        <button class="primary">Join</button>
      </form>
    </div>

    {% if classrooms %}
      <div class="card">
        <h2>Your Classes</h2>
        <div class="class-list">
          {% for c in classrooms %}
            <div class="class-chip">
              <div>{{ c.name }}</div>
              <div class="muted">Code: {{ c.code }}</div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <div class="card">
        <h2>Your Classes</h2>
        <p class="muted">You haven't joined a classroom yet.</p>
      </div>
    {% endif %}
  </aside>
</div>

{% endblock %}
